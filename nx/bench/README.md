# Nx Benchmarks

This directory contains benchmarks for the nx library. We provide comparative benchmarks against NumPy.

Additional focused suites live under subdirectories:

- `conv2d/` for convolutional workloads
- `einsum/` for tensor contractions
- `matmul/` for dense matrix multiplication

## Results Nx

```
┌────────────────────────────┬──────────┬──────────┬─────────┬─────────┬────────────┐
│ Name                       │ Wall/Run │  CPU/Run │ mWd/Run │ Speedup │ vs Fastest │
├────────────────────────────┼──────────┼──────────┼─────────┼─────────┼────────────┤
│ Transpose 500x500 f32 (Nx) │ 143.24ns │ 167.35ns │ 114.00w │   1.00x │       100% │
│ Transpose 100x100 f32 (Nx) │ 146.97ns │ 154.23ns │ 114.00w │   0.97x │       103% │
│ Transpose 500x500 f64 (Nx) │ 152.58ns │ 205.50ns │ 114.00w │   0.94x │       107% │
│ Transpose 50x50 f64 (Nx)   │ 157.30ns │ 189.22ns │ 114.00w │   0.91x │       110% │
│ Transpose 200x200 f32 (Nx) │ 164.01ns │ 159.30ns │ 114.00w │   0.87x │       114% │
│ Transpose 200x200 f64 (Nx) │ 169.60ns │ 147.01ns │ 114.00w │   0.84x │       118% │
│ Transpose 100x100 f64 (Nx) │ 171.91ns │ 149.12ns │ 114.00w │   0.83x │       120% │
│ Transpose 50x50 f32 (Nx)   │ 173.75ns │ 167.75ns │ 114.00w │   0.82x │       121% │
│ MatMul 50x50 f32 (Nx)      │   6.96μs │   6.91μs │ 759.00w │   0.02x │      4856% │
│ MatMul 50x50 f64 (Nx)      │   8.00μs │   8.10μs │ 759.00w │   0.02x │      5588% │
│ Sum 50x50 f32 (Nx)         │   8.31μs │   8.30μs │ 416.00w │   0.02x │      5804% │
│ Sum 50x50 f64 (Nx)         │   8.34μs │   8.36μs │ 416.00w │   0.02x │      5825% │
│ Sum 100x100 f64 (Nx)       │  29.25μs │  29.27μs │ 416.00w │   0.00x │     20422% │
│ Sum 100x100 f32 (Nx)       │  30.14μs │  29.92μs │ 416.00w │   0.00x │     21040% │
│ Mul 50x50 f32 (Nx)         │  39.87μs │  73.83μs │ 808.00w │   0.00x │     27837% │
│ Mul 50x50 f64 (Nx)         │  40.53μs │  74.83μs │ 808.00w │   0.00x │     28291% │
│ Add 50x50 f64 (Nx)         │  42.06μs │  80.64μs │ 808.00w │   0.00x │     29364% │
│ Mul 100x100 f32 (Nx)       │  42.80μs │  79.98μs │ 808.00w │   0.00x │     29880% │
│ Add 50x50 f32 (Nx)         │  44.69μs │  83.04μs │ 808.00w │   0.00x │     31199% │
│ Add 100x100 f32 (Nx)       │  45.93μs │  86.71μs │ 808.00w │   0.00x │     32061% │
│ Add 100x100 f64 (Nx)       │  80.08μs │ 124.27μs │ 801.00w │   0.00x │     55905% │
│ Mul 100x100 f64 (Nx)       │  80.29μs │ 122.39μs │ 801.00w │   0.00x │     56050% │
│ MatMul 100x100 f32 (Nx)    │ 104.18μs │ 220.29μs │ 759.00w │   0.00x │     72727% │
│ Mul 200x200 f32 (Nx)       │ 108.33μs │ 156.90μs │ 801.00w │   0.00x │     75630% │
│ Sum 200x200 f64 (Nx)       │ 112.39μs │ 112.40μs │ 416.00w │   0.00x │     78461% │
│ Sum 200x200 f32 (Nx)       │ 113.20μs │ 113.23μs │ 416.00w │   0.00x │     79027% │
│ Add 200x200 f32 (Nx)       │ 114.90μs │ 166.40μs │ 801.00w │   0.00x │     80212% │
│ MatMul 100x100 f64 (Nx)    │ 143.36μs │ 264.33μs │ 752.00w │   0.00x │    100080% │
│ Mul 200x200 f64 (Nx)       │ 158.02μs │ 211.38μs │ 801.00w │   0.00x │    110313% │
│ Add 200x200 f64 (Nx)       │ 168.63μs │ 231.39μs │ 801.00w │   0.00x │    117725% │
│ Mul 500x500 f32 (Nx)       │ 201.33μs │ 275.75μs │ 801.00w │   0.00x │    140551% │
│ Add 500x500 f32 (Nx)       │ 210.67μs │ 294.28μs │ 801.00w │   0.00x │    147069% │
│ MatMul 200x200 f32 (Nx)    │ 277.80μs │   1.17ms │ 752.00w │   0.00x │    193935% │
│ Mul 500x500 f64 (Nx)       │ 283.98μs │ 552.28μs │ 801.00w │   0.00x │    198249% │
│ Add 500x500 f64 (Nx)       │ 297.72μs │ 600.61μs │ 801.00w │   0.00x │    207842% │
│ MatMul 200x200 f64 (Nx)    │ 356.41μs │   1.49ms │ 752.00w │   0.00x │    248812% │
│ Sum 500x500 f32 (Nx)       │ 697.49μs │ 695.48μs │ 416.00w │   0.00x │    486928% │
│ Sum 500x500 f64 (Nx)       │ 699.95μs │ 698.24μs │ 416.00w │   0.00x │    488648% │
└────────────────────────────┴──────────┴──────────┴─────────┴─────────┴────────────┘
```

## Results NumPy

```
┌───────────────────────────────┬──────────┬──────────┬─────────┬─────────┬────────────┐
│ Name                          │ Wall/Run │  CPU/Run │ mWd/Run │ Speedup │ vs Fastest │
├───────────────────────────────┼──────────┼──────────┼─────────┼─────────┼────────────┤
│ Transpose 200x200 f32 (NumPy) │ 309.45ns │ 309.03ns │   0.04w │   1.00x │       100% │
│ Transpose 50x50 f32 (NumPy)   │ 310.05ns │ 309.76ns │   0.04w │   1.00x │       100% │
│ Transpose 100x100 f32 (NumPy) │ 312.38ns │ 311.05ns │   0.04w │   0.99x │       101% │
│ Transpose 500x500 f64 (NumPy) │ 312.63ns │ 311.97ns │   0.06w │   0.99x │       101% │
│ Transpose 500x500 f32 (NumPy) │ 313.95ns │ 312.72ns │   0.05w │   0.99x │       101% │
│ Transpose 200x200 f64 (NumPy) │ 316.98ns │ 314.56ns │   0.04w │   0.98x │       102% │
│ Transpose 50x50 f64 (NumPy)   │ 317.45ns │ 314.53ns │   0.04w │   0.97x │       103% │
│ Transpose 100x100 f64 (NumPy) │ 326.61ns │ 315.38ns │   0.04w │   0.95x │       106% │
│ Add 50x50 f32 (NumPy)         │ 527.15ns │ 526.49ns │   0.06w │   0.59x │       170% │
│ Mul 50x50 f32 (NumPy)         │ 547.39ns │ 545.74ns │   0.06w │   0.57x │       177% │
│ Mul 50x50 f64 (NumPy)         │ 683.18ns │ 681.07ns │   0.08w │   0.45x │       221% │
│ Add 50x50 f64 (NumPy)         │ 701.83ns │ 699.94ns │   0.08w │   0.44x │       227% │
│ Mul 100x100 f32 (NumPy)       │   1.05µs │   1.04µs │   0.11w │   0.30x │       338% │
│ Add 100x100 f32 (NumPy)       │   1.06µs │   1.06µs │   0.11w │   0.29x │       344% │
│ Sum 50x50 f64 (NumPy)         │   1.91µs │   1.89µs │   0.19w │   0.16x │       617% │
│ Sum 50x50 f32 (NumPy)         │   1.93µs │   1.90µs │   0.23w │   0.16x │       623% │
│ MatMul 50x50 f32 (NumPy)      │   2.43µs │   2.26µs │   0.34w │   0.13x │       785% │
│ Add 100x100 f64 (NumPy)       │   2.48µs │   2.47µs │   0.25w │   0.12x │       802% │
│ Mul 100x100 f64 (NumPy)       │   2.50µs │   2.50µs │   0.30w │   0.12x │       808% │
│ MatMul 50x50 f64 (NumPy)      │   3.02µs │   2.98µs │   0.30w │   0.10x │       975% │
│ Sum 100x100 f32 (NumPy)       │   3.24µs │   3.20µs │   0.33w │   0.10x │      1047% │
│ Sum 100x100 f64 (NumPy)       │   3.25µs │   3.24µs │   0.40w │   0.10x │      1049% │
│ Add 200x200 f32 (NumPy)       │   4.33µs │   4.33µs │   0.52w │   0.07x │      1400% │
│ Mul 200x200 f32 (NumPy)       │   4.38µs │   4.37µs │   0.52w │   0.07x │      1414% │
│ MatMul 100x100 f32 (NumPy)    │   4.73µs │   4.70µs │   0.51w │   0.07x │      1527% │
│ Add 200x200 f64 (NumPy)       │   8.18µs │   8.17µs │   0.91w │   0.04x │      2644% │
│ Mul 200x200 f64 (NumPy)       │   8.23µs │   8.21µs │   0.92w │   0.04x │      2661% │
│ Sum 200x200 f32 (NumPy)       │   9.10µs │   8.93µs │   1.08w │   0.03x │      2940% │
│ Sum 200x200 f64 (NumPy)       │   9.42µs │   9.41µs │   1.20w │   0.03x │      3045% │
│ MatMul 100x100 f64 (NumPy)    │  10.57µs │  10.56µs │   1.13w │   0.03x │      3416% │
│ MatMul 200x200 f32 (NumPy)    │  19.22µs │  19.19µs │   1.94w │   0.02x │      6212% │
│ Add 500x500 f32 (NumPy)       │  25.21µs │  25.15µs │   2.86w │   0.01x │      8146% │
│ Mul 500x500 f32 (NumPy)       │  25.28µs │  25.00µs │   2.94w │   0.01x │      8169% │
│ Sum 500x500 f32 (NumPy)       │  43.01µs │  42.89µs │   5.09w │   0.01x │     13898% │
│ Sum 500x500 f64 (NumPy)       │  47.03µs │  47.01µs │   8.00w │   0.01x │     15196% │
│ MatMul 200x200 f64 (NumPy)    │  55.00µs │  54.63µs │   5.73w │   0.01x │     17773% │
│ Mul 500x500 f64 (NumPy)       │ 151.94µs │ 151.87µs │  22.65w │   0.00x │     49099% │
│ Add 500x500 f64 (NumPy)       │ 161.35µs │ 160.99µs │  28.48w │   0.00x │     52140% │
└───────────────────────────────┴──────────┴──────────┴─────────┴─────────┴────────────┘
```
