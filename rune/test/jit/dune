(library
 (name test_rune_jit_support)
 (modules support)
 (wrapped false)
 (libraries rune_jit alcotest))

(test
 (name test_metal)
 (package rune)
 (modules test_metal)
 (deps
  (source_tree golden))
 (build_if
  (= %{system} "macosx"))
 (libraries
  alcotest
  bigarray_ext
  rune_jit
  rune_jit_metal
  test_rune_jit_support))

(test
 (name test_llvm)
 (package rune)
 (modules test_llvm)
 (libraries
  alcotest
  bigarray_ext
  rune_jit
  rune_jit_llvm
  test_rune_jit_support))
