# Nx Benchmarks

This directory contains benchmarks for the nx library. We provide comparative benchmarks against NumPy.

Additional focused suites live under subdirectories:

- `conv2d/` for convolutional workloads
- `einsum/` for tensor contractions
- `matmul/` for dense matrix multiplication

## Results Nx

```
┌────────────────────────────┬──────────┬──────────┬─────────┬─────────┬────────────┐
│ Name                       │ Wall/Run │  CPU/Run │ mWd/Run │ Speedup │ vs Fastest │
├────────────────────────────┼──────────┼──────────┼─────────┼─────────┼────────────┤
│ Transpose 100x100 f32 (Nx) │ 135.90ns │ 157.95ns │ 114.00w │   1.00x │       100% │
│ Transpose 100x100 f64 (Nx) │ 144.38ns │ 174.23ns │ 114.00w │   0.94x │       106% │
│ Transpose 200x200 f32 (Nx) │ 150.68ns │ 156.74ns │ 114.00w │   0.90x │       111% │
│ Transpose 500x500 f64 (Nx) │ 153.72ns │ 235.62ns │ 114.00w │   0.88x │       113% │
│ Transpose 50x50 f64 (Nx)   │ 155.63ns │ 167.20ns │ 114.00w │   0.87x │       115% │
│ Transpose 200x200 f64 (Nx) │ 155.87ns │ 215.74ns │ 114.00w │   0.87x │       115% │
│ Transpose 500x500 f32 (Nx) │ 157.44ns │ 191.33ns │ 114.00w │   0.86x │       116% │
│ Transpose 50x50 f32 (Nx)   │ 159.32ns │ 193.35ns │ 114.00w │   0.85x │       117% │
│ Sum 50x50 f64 (Nx)         │   8.26μs │   8.27μs │ 416.00w │   0.02x │      6077% │
│ Sum 50x50 f32 (Nx)         │   8.34μs │   8.33μs │ 416.00w │   0.02x │      6136% │
│ Sum 100x100 f64 (Nx)       │  29.18μs │  29.22μs │ 416.00w │   0.00x │     21469% │
│ Sum 100x100 f32 (Nx)       │  29.30μs │  29.27μs │ 416.00w │   0.00x │     21559% │
│ Mul 50x50 f32 (Nx)         │  39.03μs │  71.42μs │ 808.00w │   0.00x │     28720% │
│ Mul 50x50 f64 (Nx)         │  40.07μs │  74.82μs │ 808.00w │   0.00x │     29488% │
│ Add 50x50 f32 (Nx)         │  41.07μs │  79.06μs │ 808.00w │   0.00x │     30222% │
│ Mul 100x100 f32 (Nx)       │  42.03μs │  78.73μs │ 808.00w │   0.00x │     30930% │
│ Add 50x50 f64 (Nx)         │  42.89μs │  80.86μs │ 808.00w │   0.00x │     31563% │
│ Add 100x100 f32 (Nx)       │  49.83μs │  95.13μs │ 808.00w │   0.00x │     36666% │
│ Mul 100x100 f64 (Nx)       │  76.75μs │ 120.03μs │ 801.00w │   0.00x │     56477% │
│ Add 100x100 f64 (Nx)       │  81.06μs │ 129.05μs │ 801.00w │   0.00x │     59645% │
│ Mul 200x200 f32 (Nx)       │ 109.05μs │ 157.28μs │ 801.00w │   0.00x │     80246% │
│ Add 200x200 f32 (Nx)       │ 109.63μs │ 167.37μs │ 801.00w │   0.00x │     80667% │
│ Sum 200x200 f64 (Nx)       │ 113.30μs │ 113.21μs │ 416.00w │   0.00x │     83373% │
│ Sum 200x200 f32 (Nx)       │ 146.18μs │ 116.40μs │ 416.00w │   0.00x │    107569% │
│ Mul 200x200 f64 (Nx)       │ 158.72μs │ 207.01μs │ 801.00w │   0.00x │    116790% │
│ Add 200x200 f64 (Nx)       │ 161.43μs │ 218.97μs │ 801.00w │   0.00x │    118791% │
│ Add 500x500 f32 (Nx)       │ 192.10μs │ 277.27μs │ 801.00w │   0.00x │    141358% │
│ Mul 500x500 f32 (Nx)       │ 193.14μs │ 270.69μs │ 801.00w │   0.00x │    142121% │
│ Mul 500x500 f64 (Nx)       │ 282.30μs │ 531.61μs │ 801.00w │   0.00x │    207727% │
│ Add 500x500 f64 (Nx)       │ 282.59μs │ 556.61μs │ 801.00w │   0.00x │    207939% │
│ Sum 500x500 f32 (Nx)       │ 692.14μs │ 691.56μs │ 416.00w │   0.00x │    509305% │
│ Sum 500x500 f64 (Nx)       │ 712.66μs │ 710.61μs │ 416.00w │   0.00x │    524409% │
└────────────────────────────┴──────────┴──────────┴─────────┴─────────┴────────────┘
```

## Results NumPy

```
┌───────────────────────────────┬──────────┬──────────┬─────────┬─────────┬────────────┐
│ Name                          │ Wall/Run │  CPU/Run │ mWd/Run │ Speedup │ vs Fastest │
├───────────────────────────────┼──────────┼──────────┼─────────┼─────────┼────────────┤
│ Transpose 200x200 f64 (NumPy) │ 309.12ns │ 308.61ns │   0.04w │   1.00x │       100% │
│ Transpose 500x500 f64 (NumPy) │ 310.86ns │ 310.27ns │   0.06w │   0.99x │       101% │
│ Transpose 100x100 f64 (NumPy) │ 311.56ns │ 309.53ns │   0.04w │   0.99x │       101% │
│ Transpose 50x50 f32 (NumPy)   │ 311.76ns │ 311.08ns │   0.04w │   0.99x │       101% │
│ Transpose 50x50 f64 (NumPy)   │ 313.21ns │ 312.09ns │   0.04w │   0.99x │       101% │
│ Transpose 200x200 f32 (NumPy) │ 313.63ns │ 312.67ns │   0.04w │   0.99x │       101% │
│ Transpose 500x500 f32 (NumPy) │ 315.64ns │ 313.60ns │   0.05w │   0.98x │       102% │
│ Transpose 100x100 f32 (NumPy) │ 322.03ns │ 315.85ns │   0.04w │   0.96x │       104% │
│ Add 50x50 f32 (NumPy)         │ 541.58ns │ 540.36ns │   0.06w │   0.57x │       175% │
│ Mul 50x50 f32 (NumPy)         │ 547.03ns │ 539.71ns │   0.06w │   0.57x │       177% │
│ Add 50x50 f64 (NumPy)         │ 688.90ns │ 688.46ns │   0.08w │   0.45x │       223% │
│ Mul 50x50 f64 (NumPy)         │ 775.58ns │ 711.24ns │   0.08w │   0.40x │       251% │
│ Mul 100x100 f32 (NumPy)       │   1.06µs │   1.06µs │   0.11w │   0.29x │       342% │
│ Add 100x100 f32 (NumPy)       │   1.08µs │   1.05µs │   0.12w │   0.29x │       351% │
│ Sum 50x50 f64 (NumPy)         │   1.88µs │   1.88µs │   0.20w │   0.16x │       608% │
│ Sum 50x50 f32 (NumPy)         │   1.90µs │   1.89µs │   0.20w │   0.16x │       615% │
│ Mul 100x100 f64 (NumPy)       │   2.54µs │   2.51µs │   0.32w │   0.12x │       822% │
│ Add 100x100 f64 (NumPy)       │   2.58µs │   2.52µs │   0.32w │   0.12x │       835% │
│ Sum 100x100 f32 (NumPy)       │   3.16µs │   3.16µs │   0.34w │   0.10x │      1023% │
│ Sum 100x100 f64 (NumPy)       │   3.16µs │   3.16µs │   0.34w │   0.10x │      1023% │
│ Mul 200x200 f32 (NumPy)       │   4.39µs │   4.37µs │   0.55w │   0.07x │      1419% │
│ Add 200x200 f32 (NumPy)       │   4.39µs │   4.38µs │   0.54w │   0.07x │      1421% │
│ Add 200x200 f64 (NumPy)       │   8.30µs │   8.21µs │   0.95w │   0.04x │      2685% │
│ Mul 200x200 f64 (NumPy)       │   8.45µs │   8.32µs │   0.97w │   0.04x │      2734% │
│ Sum 200x200 f32 (NumPy)       │   9.06µs │   8.94µs │   0.92w │   0.03x │      2931% │
│ Sum 200x200 f64 (NumPy)       │   9.53µs │   9.50µs │   1.26w │   0.03x │      3082% │
│ Add 500x500 f32 (NumPy)       │  24.95µs │  24.89µs │   3.01w │   0.01x │      8071% │
│ Mul 500x500 f32 (NumPy)       │  25.01µs │  24.95µs │   3.08w │   0.01x │      8090% │
│ Sum 500x500 f32 (NumPy)       │  43.39µs │  43.00µs │   5.57w │   0.01x │     14036% │
│ Sum 500x500 f64 (NumPy)       │  48.26µs │  48.03µs │   8.13w │   0.01x │     15614% │
│ Add 500x500 f64 (NumPy)       │ 159.37µs │ 159.03µs │  23.29w │   0.00x │     51557% │
│ Mul 500x500 f64 (NumPy)       │ 167.38µs │ 166.97µs │  28.98w │   0.00x │     54149% │
└───────────────────────────────┴──────────┴──────────┴─────────┴─────────┴────────────┘
```
